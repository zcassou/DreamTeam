CREATE DATABASE DreamTeam;

GRANT ALL
ON DreamTeam.*
TO 'dtwa'@'localhost' IDENTIFIED BY 'waDreamTeam';

CREATE TABLE User
( UserID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  Username CHAR(30) NOT NULL UNIQUE,
  Password CHAR(60) NOT NULL,
  First    CHAR(30) NOT NULL,
  Last     CHAR(30) NOT NULL,
  Email   CHAR(70) NOT NULL UNIQUE );

CREATE TABLE Game
( GameID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  Team1  INT UNSIGNED NOT NULL,
  Team2  INT UNSIGNED NOT NULL,
  dt     TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  Winner TINYINT UNSIGNED CHECK (Winner = 1 OR Winner = 2), 

  FOREIGN KEY (Team1) REFERENCES Team(TeamID) ON DELETE CASCADE,
  FOREIGN KEY (Team2) REFERENCES Team(TeamID) ON DELETE CASCADE
);

CREATE TABLE Team
( TeamID INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  Name CHAR(50) NOT NULL UNIQUE );

CREATE TABLE Prediction
( UserID INT UNSIGNED NOT NULL,
  GameID INT UNSIGNED NOT NULL,
  Winner TINYINT UNSIGNED CHECK (Winner = 1 or Winner = 2), 

  FOREIGN KEY (UserID) REFERENCES User(UserID) ON DELETE CASCADE,
  FOREIGN KEY (GameID) REFERENCES Game(GameID) ON DELETE CASCADE
);

INSERT INTO Team VALUES
(NULL, 'Tempo Storm'),
(NULL, 'B-Step'),
(NULL, 'Gale Force eSports'),
(NULL, 'Team Naventic'),
(NULL, 'Team Freedom'),
(NULL, 'No Tomorrow'),
(NULL, 'Superstars'),
(NULL, 'Team 8');

INSERT INTO Game VALUES
(NULL, 4, 1, '2017-01-20 17:00:00', 2),
(NULL, 8, 6, '2017-01-20 19:30:00', 1),
(NULL, 7, 5, '2017-01-21 17:00:00', 1),
(NULL, 3, 2, '2017-01-21 19:30:00', 1),
(NULL, 2, 8, '2017-01-22 17:00:00', 2),
(NULL, 4, 3, '2017-01-22 19:30:00', 2),
(NULL, 1, 5, '2017-01-27 17:00:00', 1),
(NULL, 7, 6, '2017-01-27 19:30:00', 1),
(NULL, 1, 2, '2017-01-28 17:00:00', 1),
(NULL, 4, 6, '2017-01-28 19:30:00', 1),
(NULL, 3, 5, '2017-01-29 17:00:00', 2),
(NULL, 8, 7, '2017-01-29 19:30:00', 1),
(NULL, 6, 2, '2017-02-03 17:00:00', 2),
(NULL, 3, 7, '2017-02-03 19:30:00', 1),
(NULL, 4, 5, '2017-02-04 17:00:00', 2),
(NULL, 1, 8, '2017-02-04 19:30:00', 1),
(NULL, 3, 8, '2017-02-05 17:00:00', 2),
(NULL, 5, 2, '2017-02-05 19:30:00', 2),
(NULL, 1, 6, '2017-02-10 17:00:00', 1),
(NULL, 4, 7, '2017-02-10 19:30:00', 2),
(NULL, 7, 2, '2017-02-11 17:00:00', 2),
(NULL, 4, 8, '2017-02-11 19:30:00', 2),
(NULL, 1, 3, '2017-02-12 17:00:00', 2),
(NULL, 6, 5, '2017-02-12 19:30:00', 1);


INSERT INTO Game(Team1, Team2, dt) VALUES
(1, 3, '2017-03-20 15:30:00'),
(2, 4, '2017-03-20 16:30:00'),
(3, 5, '2017-03-20 17:30:00'),
(4, 6, '2017-03-20 18:30:00'),
(5, 7, '2017-03-20 19:30:00'),
(6, 8, '2017-03-20 20:30:00'),
(7, 1, '2017-03-20 21:30:00'),
(8, 2, '2017-03-20 22:30:00'),
(1, 4, '2017-03-20 23:30:00'),
(2, 5, '2017-03-20 14:30:00');
